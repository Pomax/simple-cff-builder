<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>SFNT test</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>

    <header>
      <h1>Generating full CFF-flavoured OpenType fonts on the web</h1>
      <h3>- By <a href="http://twitter.com/TheRealPomax">Pomax</a></h3>
    </header>

    <p>
      Let's test a bit of web fonting: the following should look like a two rectangles: <span class="customfont">ABC, RECTANGLE</span>.
    </p>

    <p>
      If you view-source this page, you'll see that there are actually full words in the span
      that gets styled with rectangles. That's odd... so what's going on?
    </p>

    <p>
      There's three things at work here. First, the font used is generated by page JavaScript.
      This is a <span class="fsize"></span> byte <a href="https://github.com/Pomax/simple-cff-builder">full spec-compliant OpenType font is generated</a>
      based on <a href="https://github.com/Pomax/simple-cff-builder/blob/gh-pages/testfont.js#L31-L64">a few simple parameters</a>,
      using the <a href="https://partners.adobe.com/public/developer/en/font/5177.Type2.pdf">Type2 outline instruction set</a> in a
      <a href="https://partners.adobe.com/public/developer/en/font/5176.CFF.pdf">CFF</a> block,
      rather than the simpler (and less expressive)
      <a href="https://www.microsoft.com/en-us/Typography/SpecificationsOverview.aspx">TrueType outline instruction set</a> (in .doc
      format only, unfortunately).

      Secondly, the Type2 outlines are generated on the fly
      using a <a href="https://github.com/Pomax/node-type2-charstring">human-readable instruction converter</a>.
      Third, the font makes uses of the GSUB substitution concept that OpenType fonts support, to effect two substitutions "ABC" -> "a" (styled as a little box)
      and "RECTANGLE" -> "r" (also styled as a little box),
      but only if the font is used in a "default script/language" setting...
      <a href="https://www.microsoft.com/typography/otspec/chapter2.htm">GSUB is voodoo black magic</a>, but also really powerful.
    </p>

    <div>
    	<h2>GSUB content for the font you see on this page:</h2>
    	<pre id="gsub"></pre>
    </div>

    <h1>Taking things further</h1>

    <p>
      We can actually do much more here, because the simple CFF builder also supports
      Type2 global subroutines, which means it lets you call "functions" as part of a character's
      outline instruction. Type2 supports some basic arithmetic operations, and those are enough
      to implement things like trigonometry (think sine and cosine) and linear algebra (effectively,
      matrix transformations). With those, it becomes possible to do some really cool stuff,
      although browsers don't currently support them: the font sanitizer that Firefox and Chrome
      use to check whether a font is safe is currently <a href="https://github.com/khaledhosny/ots/issues/83">not doing the right thing</a>,
      and FreeType, the text engine that is used to actually render outlines for fonts, has
      <a href="https://savannah.nongnu.org/bugs/?46489">no support for the necessary operations</a> at the moment. However, those
      things can be fixed, and fix them we will, and once they're fixed, landed, and Firefox
      and Chrome are running updated versions, there might just be some <a href="https://www.fontfont.com/fonts/beowolf">Amazing things
      for you to explore in web typography</a>.
    </p>

    <div>
    	<h2>CFF global subroutines for the more creative font:</h2>
    	<pre id="cffgsubr"></pre>
    </div>

    <p>This will not work in the browser, but you can <a id="download" href="" download="">download the more creative font as OTF file</a>, and see what it looks like when you preview it on your computer, instead.</p>

    <script src="convert.js"></script>
    <script src="sfnt.js"></script>
    <script src="common.js"></script>
    <script src="testfont.js"></script>
    <script src="testcreative.js"></script>
  </body>
</html>
